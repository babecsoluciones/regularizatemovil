<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Regularizate Movil</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="assets/css/normalize.css">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/themify-icons.css">
    <link rel="stylesheet" href="assets/css/flag-icon.min.css">
    <link rel="stylesheet" href="assets/css/cs-skin-elastic.css">
    <!-- <link rel="stylesheet" href="assets/css/bootstrap-select.less"> -->
    <link rel="stylesheet" href="assets/scss/style.css">
    
    <script src="js/jquery-3.3.1.min.js" crossorigin="anonymous"></script>

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800' rel='stylesheet' type='text/css'>

    <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv.min.js"></script> -->

</head>
<body>
        <!-- Left Panel -->

    <aside id="left-panel" class="left-panel">
        <nav class="navbar navbar-expand-sm navbar-default">

            <div class="navbar-header">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fa fa-bars"></i>
                </button>
                <!--<a class="navbar-brand" href="./"><img src="images/icn-app.png" alt="Logo" width="17" height="17"></a>
                <a class="navbar-brand hidden" href="./"><img src="images/icn-app.png" alt="Logo" width="17" height="17"></a>-->
            </div>

            <div id="main-menu" class="main-menu collapse navbar-collapse navbar-fixed-top">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="index.html"> <i class="menu-icon fa fa-dashboard"></i>Inicio </a>
                    </li>
                    
                    <li>
                        <a href="negocios.html"> <i class="menu-icon ti-briefcase"></i>Negocios </a>
                    </li>
                    <li>
                        <a href="promociones.html"> <i class="menu-icon ti-money"></i>Promociones </a>
                    </li>
                    <li>
                        <a href="empleo.html"> <i class="menu-icon ti-notepad"></i>Bolsa de Trabajo </a>
                    </li>
                    <li>
                        <a href="cursos.html"> <i class="menu-icon ti-tablet"></i>Capacitaci&oacute;n </a>
                    </li>
                     <li>
                        <a href="patrocinadores.html"> <i class="menu-icon fa fa-dashboard"></i>Patrocinadores </a>
                    </li>
                    
                </ul>
            </div><!-- /.navbar-collapse -->
        </nav>
    </aside><!-- /#left-panel -->

    <!-- Left Panel -->

    <!-- Right Panel -->

    <div id="right-panel" class="right-panel">

       
        <!-- Header-->

        

        <div class="content mt-3">
            <div class="animated fadeIn">
                <div class="row" id="negocios">

                    

           <img src="ldrs/loader.gif">

                    


                </div><!-- .row -->
            </div><!-- .animated -->
        </div><!-- .content -->


    </div><!-- /#right-panel -->

    <!-- Right Panel -->
     <div style="display:none;">
    <form id="test" name="test" method="post">
<input type="hidden" id="tipo" name="tipo" readonly value="cata-neg"><br>
<input type="hidden" id="valor" name="valor" readonly ><br>
        </form>
    </div>

    <script src="assets/js/vendor/jquery-2.1.4.min.js"></script>
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/plugins.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="js/aplicacion.js"></script>
    
    <script type="application/javascript">
	
		function enviar(cadena)
		{
            var tipo = document.getElementById('tipo').value;
			$.ajax({
				type: "POST",
				url: "https://regularizate.org/api/",
				data: cadena,
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: function(data){
					
                    if(tipo=='cata-neg')
                        {
                            
                            document.getElementById('negocios').innerHTML = "";
                            for(var i=0;i<data.length;i++)
                            {
                                var valor = data[i].valor,
                                    imagen = data[i].imagen;
                                
                                var indice = i;
                                
                                var activo = (i==0) ? 'active' : '';
                                
                                catalogo(valor, imagen);
                            }
                        }
                    if(tipo=='cons-neg')
                        {
                            document.getElementById('negocios').innerHTML = "";
                            document.getElementById('negocios').innerHTML = "<div class=\"col-md-12\" style=\"padding-bottom:15px;\"><center><input type=\"button\" onclick=\"resetear()\" value=\"Borrar filtros\"></div></center>";
                            for(var i=0;i<data.length;i++)
                            {
                                var codigo = data[i].codigo,
                                    nombre = data[i].nombre,
                                    logotipo = data[i].logotipo,
                                    categoria = data[i].categoria,
                                    domicilio = data[i].domicilio,
                                    horario = data[i].horario,
                                    direccion = data[i].direccion,
                                    descripcion = data[i].descripcion,
                                    fotos = data[i].fotos,
                                    web = data[i].web;
                                    
                                myFunction(codigo,logotipo, nombre, categoria, domicilio, direccion, fotos, web, horario,descripcion);
                            }
                        }
                    
				},
				failure: function(errMsg) {
					alert('Error al obtener los datos.\nComprueba tu enlace a internet');
				}
			});
		}
		
		function toJSONString( form ,res) {
  		var form1 = document.getElementById(form);
		var obj = {};
		var elements = form1.querySelectorAll( "input, select, textarea" );
		for( var i = 0; i < elements.length; ++i ) {
			var element = elements[i];
			var name = element.name;
			var value = element.value;

			if( name ) {
				obj[ name ] = value;
			}
		}
			
			enviar(JSON.stringify( obj ));
            
	}
        
        function myFunction(codigo,logotipo, nombre, categoria, domicilio, direccion, fotos, web, horario,descripcion) {
    
            var destino = document.getElementById('negocios');
            
            var contenido = '';
            
            
           contenido += ' <div class="col-md-4">';
           contenido += '             <a href="#" onclick="buscarNegocio(\''+codigo+'\')"><div class="card">';
           contenido += '                 <div class="card-header">';
           contenido += '                     <strong class="card-title mb-3">'+nombre+'</strong>';
           contenido += '                 </div>';
           contenido += '                 <div class="card-body">';
           contenido += '                     <div class="mx-auto d-block">';
           contenido += '                         <img class="rounded-circle mx-auto d-block" src="'+logotipo+'" alt="Regularizate">';
           contenido += '                         <h5 class="text-sm-center mt-2 mb-1"></h5>';
           contenido += '                         <div class="location text-sm-center"><i class="fa fa-map-marker"></i> '+direccion+'</div>';
           contenido += '                     </div>';
           contenido += '                     <hr>';
           contenido += '                 </div>';
           contenido += '             </div></a>';
           contenido += '         </div>';
            
    
    destino.innerHTML += contenido;
   
}
      
        function catalogo(valor, imagen) {
    var slider = document.getElementById("negocios");
            
    var contenido = '';
            
            contenido += '<div class="col-xl-3 col-lg-6">';
            contenido += '    <a href="#" onclick="seccion(\''+valor+'\',\'cons-neg\')"><div class="card">';
            contenido += '        <div class="card-body">';
            contenido += '            <div class="stat-widget-one">';
            contenido += '                <div class="stat-icon dib"><img src="'+imagen+'" alt="Regularizate" ></div>';
            contenido += '                <div class="stat-content dib">';
            contenido += '                    <div class="stat-text"> </div>';
            contenido += '                    <div class="stat-digit">'+valor+'</div>';
            contenido += '                </div>';
            contenido += '            </div>';
            contenido += '        </div>';
            contenido += '    </div></a>';
            contenido += '</div>';
           
    
    slider.innerHTML += contenido;
}
      function seccion(valor, tipo)
      {
          document.getElementById('tipo').value = tipo;
          document.getElementById('valor').value = valor;
          
          
          
          toJSONString('test','res');
      }
      
      function resetear()
      {
          document.getElementById('tipo').value = "cata-neg";
          document.getElementById('valor').value = "";
          window.location="negocios.html";
          toJSONString('test','res');
      }
      toJSONString('test','res');
	
	</script>

</body>
</html>
