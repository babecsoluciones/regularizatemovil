<!DOCTYPE html>
<html lang="zxx">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="icon" href="images/favicon.png">
	<title>Regularízate Móvil</title>

	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<link rel="stylesheet" href="css/materialize.css">
	<link rel="stylesheet" href="css/loaders.css">
	<link rel="stylesheet" href="css/lightbox.css">
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/owl.carousel.min.css">
	<link rel="stylesheet" href="css/owl.theme.default.min.css">
	<link rel="stylesheet" href="css/style.css">

</head>
<body>
	
	<!-- navbar -->
	<div class="navbar">
		<div class="container">
			<div class="row">
				<div class="col s9">
					<div class="content-left">
						
					</div>
				</div>
				<div class="col s3">
					<div class="content-right">
						<a href="#slide-out" data-activates="slide-out" class="sidebar"><i class="fa fa-bars"></i></a>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end navbar -->
	
	<!-- sidebar -->
	<div class="sidebar-panel">
		<ul id="slide-out" class="collapsible side-nav">
			<li>
				<div class="user-view">
					<div class="background">
						<img src="images/bg-user.jpg" alt="">
					</div>
					<img class="circle responsive-img" src="images/icn-app.png" alt="">
				</div>
			</li>
            <li><a href="negocios.html"><i class="fa fa-shopping-cart turqoise"></i>Negocios</a></li>
            <li><a href="promociones.html"><i class="fa fa-dollar turqoise"></i>Promociones</a></li>
            <li><a href="capacitacion.html"><i class="fa fa-spinner wizteria"></i>Capacitaci&oacute;n</a></li>
            <li><a href="empleo.html"><i class="fa fa-users belize"></i>Bolsa de Trabajo</a></li>
			<li><a href="sign-in.html" id="lnkUsuario"><i class="fa fa-sign-in belize"></i>Iniciar Sesi&oacute;n</a></li>
			<li><a href="sign-up.html"><i class="fa fa-user-plus wizteria"></i>Registrarme</a></li>
			<li id="logout"><a href="index.html"><i class="fa fa-share carrot"></i>Cerrar Sesi&oacute;n</a></li>
		</ul>
	</div>
	<!-- end sidebar -->

	<!-- about -->
	<div class="segments-page">
		<div class="container">
			<div class="about">
				<div class="pages-title">
					<h3 id="busqueda"></h3>
				</div>
				<div class="content">
                    <center>
					<img src="images/icn-app.png" style="max-width: 350px; max-height:350px;" alt="" id="imagen">
					</center>
					
                    <p id="vacante"></p>
					<p></p>
					<p id="contacto"></p>
                    
				</div>
			</div>
		</div>
        
        <div class="signin-contents">
			<div class="pages-title">
				<h3>Postularme</h3>
				<div class="line"></div>
			</div>
			 <form id="test" name="test" method="post">
				<input type="text" placeholder="Nombre completo">
				<input type="email" placeholder="E-mail">
                C.V. <input type="file" id="archivo" name="archivo" onchange="readURL(this);">
                <input type="hidden" id="cv" name="cv">
                <input type="hidden" id="tipo" name="tipo" readonly value="deta-vac">
<input type="hidden" id="codigo" name="codigo" readonly>
				<button class="button" onclick="postularme()"><i class="fa fa-send"></i>Postularme</button>
			</form>
			
		</div>
	</div>
	<!-- end about -->
    
	<script src="js/jquery.min.js"></script>
	<script src="js/materialize.js"></script>
	<script src="js/owl.carousel.min.js"></script>
	<script src="js/main.js"></script>
    <script src="js/aplicacion.js"></script>
    
     <script type="application/javascript">
	
		function enviar(cadena)
		{
			$.ajax({
				type: "POST",
				url: "https://regularizate.org/api/",
				data: cadena,
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: function(data){
                    if(document.getElementById('tipo').value=="post-vac")
                        {
                            if(data.correcto=="YES")
                                {
                                    alert("Tu postulacion se ha enviado satisfactoriamente");
                                }
                            else
                                {
                                    alert("Hubo un error al enviar tu postulacion, trabajaremos para resolver este conflicto");
                                }
                        }
                    else
                        {
                            
                    document.getElementById('busqueda').innerHTML = data.titulo;
                    
                    document.getElementById('vacante').innerHTML = data.vacante;
                    
                    document.getElementById('contacto').innerHTML = 'Para mayor información contactar a<br>Nombre:'+data.nombre+'<br>Puesto:'+data.puesto+'<br>E-mail:'+data.email+'<br>Teléfono:'+data.telefono;        
                        
                        }
				},
				failure: function(errMsg) {
					alert('Error al obtener los datos.\nComprueba tu enlace a internet');
				}
			});
		}
		
		function toJSONString( form ,res) {
  		var form1 = document.getElementById(form);
		var obj = {};
		var elements = form1.querySelectorAll( "input, select, textarea" );
		for( var i = 0; i < elements.length; ++i ) {
			var element = elements[i];
			var name = element.name;
			var value = element.value;

			if( name ) {
				obj[ name ] = value;
			}
		}
			
			enviar(JSON.stringify( obj ));
            
	}
         
         function postularme()
         {
             document.getElementById('tipo').value = "post-vac";
             toJSONString('test','a');
         }
         
         function readURL(input) {
			if (input.files && input.files[0]) {
				var reader = new FileReader();
				reader.onload = function (e) {
					$('#falseinput').attr('src', e.target.result);
					$('#cv').val(e.target.result);
				};
				reader.readAsDataURL(input.files[0]);
			}
		}
      
      pedirVacante();
	validarUsuario();
	</script>
   
</body>
</html>